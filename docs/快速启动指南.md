# å¿«é€Ÿå¯åŠ¨æŒ‡å—

## âœ… å·²å®Œæˆçš„å·¥ä½œ

1. âœ… é¡¹ç›®ä¾èµ–å·²å®‰è£…ï¼ˆåç«¯å’Œå‰ç«¯ï¼‰
2. âœ… å‰ç«¯åº”ç”¨å·²æ„å»ºï¼ˆdistç›®å½•å·²ç”Ÿæˆï¼‰
3. âœ… ä»£ç è¯­æ³•æ£€æŸ¥é€šè¿‡
4. âœ… é¡¹ç›®ç»“æ„å®Œæ•´

## ğŸš€ å¯åŠ¨æ­¥éª¤

### 1. ç¡®ä¿ROS2 Bridgeè¿è¡Œ

åœ¨Ubuntuæœºå™¨ä¸Šï¼Œç¡®ä¿rosbridge_suiteå·²å®‰è£…å¹¶è¿è¡Œï¼š

```bash
# å®‰è£…rosbridge_suiteï¼ˆå¦‚æœæœªå®‰è£…ï¼‰
sudo apt-get install ros-humble-rosbridge-suite

# å¯åŠ¨rosbridge_server
ros2 run rosbridge_server rosbridge_websocket
```

rosbridge_serveré»˜è®¤è¿è¡Œåœ¨ `ws://localhost:9090`

### 2. é…ç½®ç¯å¢ƒå˜é‡ï¼ˆå¯é€‰ï¼‰

å¦‚æœéœ€è¦ä¿®æ”¹é…ç½®ï¼Œå¯ä»¥ç¼–è¾‘ `.env` æ–‡ä»¶ï¼š

```bash
# å¤åˆ¶ç¤ºä¾‹é…ç½®ï¼ˆå¦‚æœ.envä¸å­˜åœ¨ï¼‰
cp .env.example .env

# ç¼–è¾‘é…ç½®
nano .env
```

### 3. å¯åŠ¨åº”ç”¨

#### å¼€å‘æ¨¡å¼ï¼ˆæ¨èç”¨äºå¼€å‘ï¼‰

```bash
# åŒæ—¶å¯åŠ¨åç«¯å’Œå‰ç«¯å¼€å‘æœåŠ¡å™¨
npm run dev
```

è¿™å°†å¯åŠ¨ï¼š
- åç«¯æœåŠ¡å™¨ï¼šhttp://localhost:3000
- å‰ç«¯å¼€å‘æœåŠ¡å™¨ï¼šhttp://localhost:5173

#### ç”Ÿäº§æ¨¡å¼

```bash
# 1. æ„å»ºå‰ç«¯ï¼ˆå¦‚æœè¿˜æœªæ„å»ºï¼‰
npm run build

# 2. å¯åŠ¨æœåŠ¡å™¨
npm start
```

æœåŠ¡å™¨å°†åœ¨ http://localhost:3000 å¯åŠ¨

### 4. å¯åŠ¨å±å¹•æµè§ˆå™¨

#### æ–¹å¼1ï¼šé€šè¿‡APIå¯åŠ¨ï¼ˆæ¨èï¼‰

```bash
# å¯åŠ¨å±å¹•0
curl -X POST http://localhost:3000/api/screens/0/start

# å¯åŠ¨æ‰€æœ‰å±å¹•ï¼ˆéœ€è¦ä¿®æ”¹ä»£ç æˆ–æ·»åŠ è„šæœ¬ï¼‰
```

#### æ–¹å¼2ï¼šæ‰‹åŠ¨å¯åŠ¨æµè§ˆå™¨

åœ¨Ubuntuæœºå™¨ä¸Šï¼Œä¸ºæ¯ä¸ªå±å¹•æ‰‹åŠ¨æ‰“å¼€æµè§ˆå™¨ï¼š

```bash
# å±å¹•0
chromium-browser --kiosk --start-fullscreen http://localhost:3000?screen=0

# å±å¹•1
chromium-browser --kiosk --start-fullscreen http://localhost:3000?screen=1

# ... ä¾æ­¤ç±»æ¨
```

### 5. éªŒè¯ç³»ç»Ÿè¿è¡Œ

#### æ£€æŸ¥å¥åº·çŠ¶æ€

```bash
curl http://localhost:3000/api/health
```

#### æ£€æŸ¥ROS2è¿æ¥çŠ¶æ€

```bash
curl http://localhost:3000/api/ros2/status
```

#### æ£€æŸ¥å±å¹•çŠ¶æ€

```bash
curl http://localhost:3000/api/screens
```

## ğŸ“‹ åœ¨Ubuntuä¸Šçš„å®Œæ•´éƒ¨ç½²æµç¨‹

### 1. å®‰è£…ç³»ç»Ÿä¾èµ–

```bash
# æ›´æ–°ç³»ç»Ÿ
sudo apt-get update

# å®‰è£…Node.jsï¼ˆå¦‚æœæœªå®‰è£…ï¼‰
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
sudo apt-get install -y nodejs

# å®‰è£…Chromium
sudo apt-get install -y chromium-browser

# å®‰è£…ROS2å’Œrosbridge_suite
sudo apt-get install -y ros-humble-rosbridge-suite
```

### 2. é…ç½®æ˜¾ç¤ºå™¨

```bash
# æ£€æµ‹æ˜¾ç¤ºå™¨
xrandr --listmonitors

# é…ç½®å¤šæ˜¾ç¤ºå™¨ï¼ˆæ ¹æ®å®é™…æƒ…å†µè°ƒæ•´ï¼‰
xrandr --output HDMI-0 --mode 1920x1080 --pos 0x0
xrandr --output DP-1 --mode 1920x1080 --pos 1920x0
# ... é…ç½®å…¶ä»–æ˜¾ç¤ºå™¨
```

### 3. éƒ¨ç½²åº”ç”¨

```bash
# å…‹éš†æˆ–å¤åˆ¶é¡¹ç›®åˆ°ç›®æ ‡æœºå™¨
cd /opt  # æˆ–ä½ é€‰æ‹©çš„ç›®å½•
git clone <your-repo> robot-cockpit
cd robot-cockpit

# å®‰è£…ä¾èµ–
npm run install:all

# æ„å»ºå‰ç«¯
npm run build

# é…ç½®ç¯å¢ƒå˜é‡
cp .env.example .env
nano .env  # æ ¹æ®éœ€è¦ä¿®æ”¹é…ç½®
```

### 4. é…ç½®å¼€æœºè‡ªå¯åŠ¨ï¼ˆsystemdï¼‰

åˆ›å»ºsystemdæœåŠ¡æ–‡ä»¶ï¼š

```bash
sudo nano /etc/systemd/system/robot-cockpit.service
```

å†…å®¹ï¼š

```ini
[Unit]
Description=Robot Cockpit Web Application
After=network.target

[Service]
Type=simple
User=your-username
WorkingDirectory=/opt/robot-cockpit
Environment="NODE_ENV=production"
Environment="PUPPETEER_SKIP_DOWNLOAD=true"
ExecStart=/usr/bin/node backend/server.js
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target
```

å¯ç”¨å¹¶å¯åŠ¨æœåŠ¡ï¼š

```bash
sudo systemctl daemon-reload
sudo systemctl enable robot-cockpit
sudo systemctl start robot-cockpit

# æŸ¥çœ‹çŠ¶æ€
sudo systemctl status robot-cockpit

# æŸ¥çœ‹æ—¥å¿—
sudo journalctl -u robot-cockpit -f
```

### 5. é…ç½®è‡ªåŠ¨å¯åŠ¨å±å¹•æµè§ˆå™¨

å¯ä»¥åˆ›å»ºä¸€ä¸ªå¯åŠ¨è„šæœ¬ï¼Œåœ¨X11ä¼šè¯å¯åŠ¨æ—¶è‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨ï¼š

```bash
# åˆ›å»ºå¯åŠ¨è„šæœ¬
nano ~/.xprofile
```

æ·»åŠ ï¼š

```bash
#!/bin/bash
sleep 5  # ç­‰å¾…æœåŠ¡å™¨å¯åŠ¨
chromium-browser --kiosk --start-fullscreen http://localhost:3000?screen=0 &
chromium-browser --kiosk --start-fullscreen http://localhost:3000?screen=1 &
# ... æ·»åŠ å…¶ä»–å±å¹•
```

## ğŸ”§ æ•…éšœæ’é™¤

### ROS2 Bridgeè¿æ¥å¤±è´¥

- æ£€æŸ¥rosbridge_serveræ˜¯å¦è¿è¡Œï¼š`ps aux | grep rosbridge`
- æ£€æŸ¥ç«¯å£9090æ˜¯å¦è¢«å ç”¨ï¼š`netstat -tuln | grep 9090`
- æ£€æŸ¥é˜²ç«å¢™è®¾ç½®

### å±å¹•æµè§ˆå™¨æ— æ³•å¯åŠ¨

- æ£€æŸ¥Puppeteeræ˜¯å¦èƒ½æ‰¾åˆ°Chromeï¼š`which chromium-browser`
- æ£€æŸ¥X11æ˜¾ç¤ºæœåŠ¡å™¨æ˜¯å¦è¿è¡Œï¼š`echo $DISPLAY`
- æ£€æŸ¥æƒé™ï¼šç¡®ä¿ç”¨æˆ·æœ‰æƒé™è®¿é—®æ˜¾ç¤ºå™¨

### WebSocketè¿æ¥å¤±è´¥

- æ£€æŸ¥åç«¯æœåŠ¡å™¨æ˜¯å¦è¿è¡Œ
- æ£€æŸ¥CORSé…ç½®
- æ£€æŸ¥é˜²ç«å¢™ç«¯å£3000æ˜¯å¦å¼€æ”¾

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **Puppeteeræµè§ˆå™¨**ï¼šåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œç¡®ä¿ç³»ç»Ÿå·²å®‰è£…Chrome/Chromiumï¼Œè®¾ç½® `PUPPETEER_SKIP_DOWNLOAD=true` è·³è¿‡ä¸‹è½½
2. **æ˜¾ç¤ºå™¨é…ç½®**ï¼šç¡®ä¿Ubuntuç³»ç»Ÿæ­£ç¡®è¯†åˆ«æ‰€æœ‰7ä¸ªæ˜¾ç¤ºå™¨
3. **ROS2è¯é¢˜**ï¼šæ ¹æ®å®é™…ROS2ç³»ç»Ÿé…ç½®ï¼Œä¿®æ”¹ `.env` ä¸­çš„ `ROS2_TOPICS`
4. **ç½‘ç»œé…ç½®**ï¼šç¡®ä¿å‰ç«¯URLé…ç½®æ­£ç¡®ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤šå±ç¯å¢ƒä¸­

## ğŸ¯ ä¸‹ä¸€æ­¥å¼€å‘

- [ ] å®ç°å¼€æœºè‡ªåŠ¨å¯åŠ¨å±å¹•æµè§ˆå™¨
- [ ] æ·»åŠ æ›´å¤šROS2è¯é¢˜çš„æ•°æ®å¯è§†åŒ–
- [ ] å®ç°å±å¹•å†…å®¹é…ç½®ç®¡ç†
- [ ] æ·»åŠ é”™è¯¯æ¢å¤æœºåˆ¶
- [ ] å®ç°æ—¥å¿—è®°å½•å’Œç›‘æ§

